!function(e){var t={};function a(n){if(t[n])return t[n].exports;var l=t[n]={i:n,l:!1,exports:{}};return e[n].call(l.exports,l,l.exports,a),l.l=!0,l.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)a.d(n,l,function(t){return e[t]}.bind(null,l));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";a.r(t);var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};const{Component:l,Fragment:i}=wp.element,{__:s}=wp.i18n;class c extends l{render(){const{isInvalid:e}=this.props;return React.createElement("tr",null,React.createElement("td",{className:"gform-settings-generic-map__column gform-settings-generic-map__column--key"},this.getKeyInput()),React.createElement("td",{className:"gform-settings-generic-map__column gform-settings-generic-map__column--value"},this.getValueInput()),React.createElement("td",{className:"gform-settings-generic-map__column gform-settings-generic-map__column--error"},e&&React.createElement("svg",{width:"22",height:"22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M11 22C4.9249 22 0 17.0751 0 11S4.9249 0 11 0s11 4.9249 11 11-4.9249 11-11 11z",fill:"#E54C3B"}),React.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.9317 5.0769a.1911.1911 0 00-.1909.2006l.3708 7.4158a.8895.8895 0 001.7768 0l.3708-7.4158a.1911.1911 0 00-.1909-.2006H9.9317zm2.3375 10.5769c0 .701-.5682 1.2693-1.2692 1.2693-.701 0-1.2692-.5683-1.2692-1.2693 0-.7009.5682-1.2692 1.2692-1.2692.701 0 1.2692.5683 1.2692 1.2692z",fill:"#fff"}))),React.createElement("td",{className:"gform-settings-generic-map__column gform-settings-generic-map__column--buttons"},this.getAddButton(),this.getDeleteButton()))}getKeyInput(){const{choice:e,index:t,mapping:a,updateMapping:l}=this.props,{choices:i,display_all:c,placeholder:r}=this.props.keyField;return e.required||c?React.createElement("label",null,e.label," ",e.required?React.createElement("span",{className:"required"},"*"):null):"gf_custom"===a.key?React.createElement("span",{className:"gform-settings-generic-map__custom"},React.createElement("input",{type:"text",value:a.custom_key,placeholder:r,onChange:e=>l(n({},a,{custom_key:e.target.value}),t)}),i.length>0&&React.createElement("button",{className:"gform-settings-generic-map__reset",onClick:e=>{e.preventDefault(),l(n({},a,{key:"",custom_key:""}),t)}},React.createElement("span",{className:"screen-reader-text"},s("Remove Custom Key","gravityforms")))):React.createElement("select",{value:a.key,onChange:e=>l(n({},a,{key:e.target.value}),t)},this.getKeyOptions().map(e=>e.choices&&e.choices.length>0?React.createElement("optgroup",{key:e.label,label:e.label},e.choices.map(t=>React.createElement("option",{key:t.value,disabled:e.disabled,value:t.value},t.label))):React.createElement("option",{key:e.value,disabled:e.disabled,value:e.value},e.label)))}getKeyOptions(){const{keyField:e,mappedChoices:t,mapping:a}=this.props,{allow_custom:n,allow_duplicates:l,choices:i}=e,c=i.map(e=>e.name||e.value);let r=[];c.includes("")||r.push({label:s("Select a Field","gravityforms"),value:"",disabled:!1});for(let e=0;e<i.length;e++){let n=i[e],s=n.name||n.value;if(n.required)continue;let c=t.includes(s)&&s!==a.key&&!l;r.push({label:n.label,value:s,choices:n.choices||[],disabled:c})}return n&&!c.includes("gf_custom")&&r.push({label:s("Add Custom Key","gravityforms"),value:"gf_custom",disabled:!1}),r}getValueInput(){const{index:e,isInvalid:t,mapping:a,updateMapping:l,valueField:i}=this.props;return"gf_custom"===a.value?React.createElement("span",{className:"gform-settings-generic-map__custom"},React.createElement("input",{type:"text",value:a.custom_value,placeholder:i.placeholder,onChange:t=>l(n({},a,{custom_value:t.target.value}),e)}),React.createElement("button",{className:"gform-settings-generic-map__reset",onClick:t=>{t.preventDefault(),l(n({},a,{value:"",custom_value:""}),e)}},React.createElement("span",{className:"screen-reader-text"},s("Remove Custom Value","gravityforms")))):React.createElement("select",{disabled:""===a.key||!a.key,value:a.value,onChange:t=>l(n({},a,{value:t.target.value}),e),className:t?"gform-settings-generic-map__value--invalid":""},this.getValueOptions().map(e=>e.choices&&e.choices.length>0?React.createElement("optgroup",{key:e.label,label:e.label},e.choices.map(e=>React.createElement("option",{key:e.value,value:e.value},e.label))):React.createElement("option",{key:e.value,value:e.value},e.label)))}getValueOptions(){const{choice:e,valueField:t}=this.props,{allow_custom:a}=t;let n=e.choices||t.choices,l=n.map(e=>e.value);return a&&!l.includes("gf_custom")&&n.push({label:s("Add Custom Value","gravityforms"),value:"gf_custom",disabled:!1}),n}getAddButton(){const{canAdd:e,addMapping:t,index:a}=this.props;return e?React.createElement("button",{className:"gform-settings-generic-map__button gform-settings-generic-map__button--add",onClick:e=>{e.preventDefault(),t(a)}},React.createElement("span",{className:"screen-reader-text"},s("Add","gravityforms"))):null}getDeleteButton(){const{canDelete:e,deleteMapping:t,index:a}=this.props;return e?React.createElement("button",{className:"gform-settings-generic-map__button gform-settings-generic-map__button--delete",onClick:e=>{e.preventDefault(),t(a)}},React.createElement("span",{className:"screen-reader-text"},s("Delete","gravityforms"))):null}}const{Component:r,render:o}=wp.element;class p extends r{constructor(){super(...arguments),this.state={mapping:JSON.parse(document.querySelector(`[name="${this.props.input}"]`).value)},this.addMapping=this.addMapping.bind(this),this.deleteMapping=this.deleteMapping.bind(this),this.getMapping=this.getMapping.bind(this),this.updateMapping=this.updateMapping.bind(this)}componentDidMount(){this.populateRequiredMappings(),0===this.getRequiredChoices().length&&this.getMapping().length<1&&this.addMapping(0)}addMapping(e){const{allow_custom:t,choices:a}=this.props.keyField;let n=this.getMapping(),l=0===a.length&&t?"gf_custom":"";n.splice(e+1,0,{key:l,custom_key:"",value:"",custom_value:""}),this.setMapping(n)}deleteMapping(e){let t=this.getMapping();t.splice(e,1),this.setMapping(t)}getMapping(){return this.state.mapping}setMapping(e){const{input:t}=this.props;this.setState({mapping:e}),document.querySelector(`[name="${t}"]`).value=JSON.stringify(e)}updateMapping(e,t){let a=this.getMapping();e.key||(e.value=""),a[t]=e,this.setMapping(a)}getChoice(e){const{choices:t}=this.props.keyField;for(let a=0;a<t.length;a++)if(t[a].name===e)return t[a];return!1}getMappedChoices(){return this.getMapping().filter(e=>e.key&&"gf_custom"!==e.key).map(e=>e.key)}getRequiredChoices(){const{choices:e,display_all:t}=this.props.keyField;return e.filter(e=>e.required||t).map(e=>e.name)}populateRequiredMappings(){const e=this.getMapping(),t=this.getRequiredChoices(),a=e.map(e=>e.key);for(let n=0;n<t.length;n++)a.includes(t[n])||e.push({key:t[n],custom_key:"",value:"",custom_value:""});for(let t=0;t<e.length;t++){if(""!==e[t].value)continue;let a=this.getChoice(e[t].key);a&&"default_value"in a&&(e[t].value=a.default_value)}this.setMapping(e)}render(){const{keyField:e,invalidChoices:t,limit:a,valueField:n}=this.props,l=this.getMapping();return React.createElement("table",{className:"gform-settings-generic-map__table",cellSpacing:"0",cellPadding:"0"},React.createElement("tbody",null,l.map((i,s)=>{let r=this.getChoice(i.key);return React.createElement(c,{key:s,mapping:i,choice:r,mappedChoices:this.getMappedChoices(),isInvalid:i.key&&t.includes(i.key),keyField:e,valueField:n,canAdd:e.allow_custom&&(0===a||l.length<=a)||!e.allow_custom&&l.length<e.choices.length,canDelete:l.length>1&&!r.required&&!e.display_all,addMapping:this.addMapping,deleteMapping:this.deleteMapping,updateMapping:this.updateMapping,index:s})})))}}window.initializeFieldMap=(e,t)=>{o(React.createElement(p,t),document.getElementById(e))}}]);