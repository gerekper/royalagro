!function(m){var f=!1;tinymce.PluginManager.add("gppcmt",function(c,t){c.addButton("gppcmt",{type:"menubutton",title:"Insert Gravity Forms Merge Tags",image:gppcmtData.gfBaseUrl+"/images/icon-drop-list.png",classes:"gppcmt",menu:[]});var e=setInterval(function(){c.controlManager.buttons.gppcmt&&(clearInterval(e),n(gppcmtData.initFormId))},100);function n(t){void 0===t&&(t=0),function(t){var p=m(c.controlManager.buttons.gppcmt.$el.find("button"));p.data("content")||p.data("content",p.html());p.html('<span style="display:inline-block;width:20px;height:20px;padding:0;text-align:center;"><img src="'+gppcmtData.gfBaseUrl+'/images/spinner.gif" style="margin-top:2px;" /></span>'),m.post(ajaxurl,{action:"gppcmt_get_form",nonce:gppcmtData.nonce,formId:t,postId:gppcmtData.postId},function(t){p.html(p.data("content"));var e=m.parseJSON(t),n=[];if(e.id){n.push({text:"â†© View All Forms",type:"back",value:-1},{text:"-"}),void 0===window.gf_vars&&(window.gf_vars={}),form=e,gf_vars.mergeTags=e.mergeTags;var a=new gfMergeTagsObj(e),s=a.getMergeTags(e.fields,"#content");for(var r in s)if(s.hasOwnProperty(r)){var o=s[r].label,i=s[r].tags;if(!(i.length<=0)){o&&n.push({text:"-"},{text:"- "+o+" -",classes:"header"});for(var g=0;g<i.length;g++)n.push({type:"field",text:u(i[g].label,40),value:i[g].tag,classes:"field"})}}}else{n.push({text:"- Select a Form -",classes:"header"});for(var g=0;g<e.length;g++)n.push({type:"form",text:e[g].title,value:e[g].id,classes:"form"})}!function(t){c.buttons.gppcmt.menu.splice(0,c.buttons.gppcmt.menu.length);for(var e=0;e<t.length;e++)c.buttons.gppcmt.menu.push({text:t[e].text,classes:t[e].classes,onclick:function(t){l(this.type,this.value)}.bind(t[e])})}(n),c.controlManager.buttons.gppcmt.menu=null,f&&m(c.getContainer()).is(":visible")&&c.controlManager.buttons.gppcmt.showMenu(),f=!0})}(t)}function l(t,e){switch(t){case"form":n(parseInt(e));break;case"back":!1,n(0);break;case"field":c.insertContent(String(e))}}function u(t,e){if(!t||t.length<=e)return t;var n=e/2;return t.substr(0,n)+"..."+t.substr(t.length-(n-1),n)}})}(jQuery);
//# sourceMappingURL=gp-post-content-merge-tags-tinymce.js.map