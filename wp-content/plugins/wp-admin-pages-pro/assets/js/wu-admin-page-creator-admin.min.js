var install_user_select;!function(o){"use strict";var i={theme:"fip-grey",source:!1,emptyIcon:!0,emptyIconValue:"",iconsPerPage:20,hasSearch:!0,searchSource:!1,useAttribute:!1,attributeName:"data-icon",convertToHex:!0,allCategoryText:"From all categories",unCategorizedText:"Uncategorized"};function s(e,t){this.element=o(e),this.settings=o.extend({},i,t),this.settings.emptyIcon&&this.settings.iconsPerPage--,this.iconPicker=o("<div/>",{class:"icons-selector",style:"position: relative",html:'<div class="selector"><span class="selected-icon"><i class="fip-icon-block"></i></span><span class="selector-button"><i class="fip-icon-down-dir"></i></span></div><div class="selector-popup" style="display: none;">'+(this.settings.hasSearch?'<div class="selector-search"><input type="text" name="" value="" placeholder="Search icon" class="icons-search-input"/><i class="fip-icon-search"></i></div>':"")+'<div class="selector-category"><select name="" class="icon-category-select" style="display: none"></select></div><div class="fip-icons-container"></div><div class="selector-footer" style="display:none;"><span class="selector-pages">1/2</span><span class="selector-arrows"><span class="selector-arrow-left" style="display:none;"><i class="fip-icon-left-dir"></i></span><span class="selector-arrow-right"><i class="fip-icon-right-dir"></i></span></span></div></div>'}),this.iconContainer=this.iconPicker.find(".fip-icons-container"),this.searchIcon=this.iconPicker.find(".selector-search i"),this.iconsSearched=[],this.isSearch=!1,this.totalPage=1,this.currentPage=1,this.currentIcon=!1,this.iconsCount=0,this.open=!1,this.searchValues=[],this.availableCategoriesSearch=[],this.triggerEvent=null,this.backupSource=[],this.backupSearch=[],this.isCategorized=!1,this.selectCategory=this.iconPicker.find(".icon-category-select"),this.selectedCategory=!1,this.availableCategories=[],this.unCategorizedKey=null,this.init()}s.prototype={init:function(){this.iconPicker.addClass(this.settings.theme),this.iconPicker.css({left:-9999}).appendTo("body");var e=this.iconPicker.outerHeight(),t=this.iconPicker.outerWidth();if(this.iconPicker.css({left:""}),this.element.before(this.iconPicker),this.element.css({visibility:"hidden",top:0,position:"relative",zIndex:"-1",left:"-"+t+"px",display:"inline-block",height:e+"px",width:t+"px",padding:"0",margin:"0 -"+t+"px 0 0",border:"0 none",verticalAlign:"top"}),!this.element.is("select")){var i=function(){for(var e=3,t=document.createElement("div"),i=t.all||[];t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><br><![endif]--\x3e",i[0];);return 4<e?e:!e}(),s=document.createElement("div");this.triggerEvent=9!==i&&"oninput"in s?["input","keyup"]:["keyup"]}!this.settings.source&&this.element.is("select")?(this.settings.source=[],this.settings.searchSource=[],this.element.find("optgroup").length?(this.isCategorized=!0,this.element.find("optgroup").each(o.proxy(function(e,t){var n=this.availableCategories.length,i=o("<option />");i.attr("value",n),i.html(o(t).attr("label")),this.selectCategory.append(i),this.availableCategories[n]=[],this.availableCategoriesSearch[n]=[],o(t).find("option").each(o.proxy(function(e,t){var i=o(t).val(),s=o(t).html();i&&i!==this.settings.emptyIconValue&&(this.settings.source.push(i),this.availableCategories[n].push(i),this.searchValues.push(s),this.availableCategoriesSearch[n].push(s))},this))},this)),this.element.find("> option").length&&this.element.find("> option").each(o.proxy(function(e,t){var i=o(t).val(),s=o(t).html();if(!i||""===i||i==this.settings.emptyIconValue)return!0;null===this.unCategorizedKey&&(this.unCategorizedKey=this.availableCategories.length,this.availableCategories[this.unCategorizedKey]=[],this.availableCategoriesSearch[this.unCategorizedKey]=[],o("<option />").attr("value",this.unCategorizedKey).html(this.settings.unCategorizedText).appendTo(this.selectCategory)),this.settings.source.push(i),this.availableCategories[this.unCategorizedKey].push(i),this.searchValues.push(s),this.availableCategoriesSearch[this.unCategorizedKey].push(s)},this))):this.element.find("option").each(o.proxy(function(e,t){var i=o(t).val(),s=o(t).html();i&&(this.settings.source.push(i),this.searchValues.push(s))},this)),this.backupSource=this.settings.source.slice(0),this.backupSearch=this.searchValues.slice(0),this.loadCategories()):this.initSourceIndex(),this.loadIcons(),this.selectCategory.on("change keyup",o.proxy(function(e){if(!1===this.isCategorized)return!1;var t=o(e.currentTarget),i=t.val();if("all"===t.val())this.settings.source=this.backupSource,this.searchValues=this.backupSearch;else{var s=parseInt(i,10);this.availableCategories[s]&&(this.settings.source=this.availableCategories[s],this.searchValues=this.availableCategoriesSearch[s])}this.resetSearch(),this.loadIcons()},this)),this.iconPicker.find(".selector-button").click(o.proxy(function(){this.toggleIconSelector()},this)),this.iconPicker.find(".selector-arrow-right").click(o.proxy(function(e){this.currentPage<this.totalPage&&(this.iconPicker.find(".selector-arrow-left").show(),this.currentPage=this.currentPage+1,this.renderIconContainer()),this.currentPage===this.totalPage&&o(e.currentTarget).hide()},this)),this.iconPicker.find(".selector-arrow-left").click(o.proxy(function(e){1<this.currentPage&&(this.iconPicker.find(".selector-arrow-right").show(),this.currentPage=this.currentPage-1,this.renderIconContainer()),1===this.currentPage&&o(e.currentTarget).hide()},this)),this.iconPicker.find(".icons-search-input").keyup(o.proxy(function(e){var i=o(e.currentTarget).val();""!==i?(this.searchIcon.removeClass("fip-icon-search"),this.searchIcon.addClass("fip-icon-cancel"),this.isSearch=!0,this.currentPage=1,this.iconsSearched=[],o.grep(this.searchValues,o.proxy(function(e,t){if(0<=e.toLowerCase().search(i.toLowerCase()))return this.iconsSearched[this.iconsSearched.length]=this.settings.source[t],!0},this)),this.renderIconContainer()):this.resetSearch()},this)),this.iconPicker.find(".selector-search").on("click",".fip-icon-cancel",o.proxy(function(){this.iconPicker.find(".icons-search-input").focus(),this.resetSearch()},this)),this.iconContainer.on("click",".fip-box",o.proxy(function(e){this.setSelectedIcon(o(e.currentTarget).find("i").attr("data-fip-value")),this.toggleIconSelector()},this)),this.iconPicker.click(function(e){return e.stopPropagation(),!1}),o("html").click(o.proxy(function(){this.open&&this.toggleIconSelector()},this))},initSourceIndex:function(){if("object"==typeof this.settings.source){if(o.isArray(this.settings.source))this.isCategorized=!1,this.selectCategory.html("").hide(),this.settings.source=o.map(this.settings.source,function(e,t){return"function"==typeof e.toString?e.toString():e}),o.isArray(this.settings.searchSource)?this.searchValues=o.map(this.settings.searchSource,function(e,t){return"function"==typeof e.toString?e.toString():e}):this.searchValues=this.settings.source.slice(0);else{var e=o.extend(!0,{},this.settings.source);for(var t in this.settings.source=[],this.searchValues=[],this.availableCategoriesSearch=[],this.selectedCategory=!1,this.availableCategories=[],this.unCategorizedKey=null,this.isCategorized=!0,this.selectCategory.html(""),e){var i=this.availableCategories.length,s=o("<option />");for(var n in s.attr("value",i),s.html(t),this.selectCategory.append(s),this.availableCategories[i]=[],this.availableCategoriesSearch[i]=[],e[t]){var a=e[t][n],c=this.settings.searchSource&&this.settings.searchSource[t]&&this.settings.searchSource[t][n]?this.settings.searchSource[t][n]:a;"function"==typeof a.toString&&(a=a.toString()),a&&a!==this.settings.emptyIconValue&&(this.settings.source.push(a),this.availableCategories[i].push(a),this.searchValues.push(c),this.availableCategoriesSearch[i].push(c))}}}this.backupSource=this.settings.source.slice(0),this.backupSearch=this.searchValues.slice(0),this.loadCategories()}},loadCategories:function(){!1!==this.isCategorized&&(o('<option value="all">'+this.settings.allCategoryText+"</option>").prependTo(this.selectCategory),this.selectCategory.show().val("all").trigger("change"))},loadIcons:function(){this.iconContainer.html('<i class="fip-icon-spin3 animate-spin loading"></i>'),this.settings.source instanceof Array&&this.renderIconContainer()},renderIconContainer:function(){var e,t=[];if(t=this.isSearch?this.iconsSearched:this.settings.source,this.iconsCount=t.length,this.totalPage=Math.ceil(this.iconsCount/this.settings.iconsPerPage),1<this.totalPage?this.iconPicker.find(".selector-footer").show():this.iconPicker.find(".selector-footer").hide(),this.iconPicker.find(".selector-pages").html(this.currentPage+"/"+this.totalPage+" <em>("+this.iconsCount+")</em>"),e=(this.currentPage-1)*this.settings.iconsPerPage,this.settings.emptyIcon)this.iconContainer.html('<span class="fip-box"><i class="fip-icon-block" data-fip-value="fip-icon-block"></i></span>');else{if(t.length<1)return void this.iconContainer.html('<span class="icons-picker-error"><i class="fip-icon-block" data-fip-value="fip-icon-block"></i></span>');this.iconContainer.html("")}t=t.slice(e,e+this.settings.iconsPerPage);for(var i,s=0;i=t[s++];){var n=i;o.grep(this.settings.source,o.proxy(function(e,t){return e===i&&(n=this.searchValues[t],!0)},this)),o("<span/>",{html:'<i data-fip-value="'+i+'" '+(this.settings.useAttribute?this.settings.attributeName+'="'+(this.settings.convertToHex?"&#x"+parseInt(i,10).toString(16)+";":i)+'"':'class="'+i+'"')+"></i>",class:"fip-box",title:n}).appendTo(this.iconContainer)}this.settings.emptyIcon||this.element.val()&&-1!==o.inArray(this.element.val(),this.settings.source)?-1===o.inArray(this.element.val(),this.settings.source)?this.setSelectedIcon():this.setSelectedIcon(this.element.val()):this.setSelectedIcon(t[0])},setHighlightedIcon:function(){this.iconContainer.find(".current-icon").removeClass("current-icon"),this.currentIcon&&this.iconContainer.find('[data-fip-value="'+this.currentIcon+'"]').parent("span").addClass("current-icon")},setSelectedIcon:function(e){if("fip-icon-block"===e&&(e=""),this.settings.useAttribute?e?this.iconPicker.find(".selected-icon").html("<i "+this.settings.attributeName+'="'+(this.settings.convertToHex?"&#x"+parseInt(e,10).toString(16)+";":e)+'"></i>'):this.iconPicker.find(".selected-icon").html('<i class="fip-icon-block"></i>'):this.iconPicker.find(".selected-icon").html('<i class="'+(e||"fip-icon-block")+'"></i>'),this.element.val(""===e?this.settings.emptyIconValue:e).trigger("change"),null!==this.triggerEvent)for(var t in this.triggerEvent)this.element.trigger(this.triggerEvent[t]);this.currentIcon=e,this.setHighlightedIcon()},toggleIconSelector:function(){this.open=this.open?0:1,this.iconPicker.find(".selector-popup").slideToggle(300),this.iconPicker.find(".selector-button i").toggleClass("fip-icon-down-dir"),this.iconPicker.find(".selector-button i").toggleClass("fip-icon-up-dir"),this.open&&this.iconPicker.find(".icons-search-input").focus().select()},resetSearch:function(){this.iconPicker.find(".icons-search-input").val(""),this.searchIcon.removeClass("fip-icon-cancel"),this.searchIcon.addClass("fip-icon-search"),this.iconPicker.find(".selector-arrow-left").hide(),this.currentPage=1,this.isSearch=!1,this.renderIconContainer(),1<this.totalPage&&this.iconPicker.find(".selector-arrow-right").show()}},o.fn.fontIconPicker=function(t){return this.each(function(){o.data(this,"fontIconPicker")||o.data(this,"fontIconPicker",new s(this,t))}),this.setIcons=o.proxy(function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this.each(function(){o.data(this,"fontIconPicker").settings.source=e,o.data(this,"fontIconPicker").settings.searchSource=t,o.data(this,"fontIconPicker").initSourceIndex(),o.data(this,"fontIconPicker").resetSearch(),o.data(this,"fontIconPicker").loadIcons()})},this),this.destroyPicker=o.proxy(function(){this.each(function(){o.data(this,"fontIconPicker")&&(o.data(this,"fontIconPicker").iconPicker.remove(),o.data(this,"fontIconPicker").element.css({visibility:"",top:"",position:"",zIndex:"",left:"",display:"",height:"",width:"",padding:"",margin:"",border:"",verticalAlign:""}),o.removeData(this,"fontIconPicker"))})},this),this.refreshPicker=o.proxy(function(e){e||(e=t),this.destroyPicker(),this.each(function(){o.data(this,"fontIconPicker")||o.data(this,"fontIconPicker",new s(this,e))})},this),this}}(jQuery),function(i){i(document).ready(function(){void 0===i.fn.select2&&(i.fn.select2=i.fn.wuSelect2),install_user_select=function(){i("#wu-ajax-users").select2({initSelection:function(e,t){i.ajax({method:"GET",url:ajaxurl+"?action=callback_target_users&term_users="+i("#wu-ajax-users").val(),dataType:"json"}).done(function(e){t(i.map(e,function(e){return{text:e.data.user_nicename+" ("+e.data.user_email+")",slug:e.data.user_nicename,id:e.data.ID}}))})},minimumInputLength:2,tags:[],ajax:{url:ajaxurl,dataType:"json",type:"GET",quietMillis:50,data:function(e){return{term_users:e,action:"callback_target_users"}},results:function(e){return{results:i.map(e,function(e){return{text:e.data.user_nicename+" ("+e.data.user_email+")",slug:e.data.user_nicename,id:e.data.ID}})}}}})},i("#wu-ajax-excludes").select2({initSelection:function(e,t){i.ajax({method:"GET",url:ajaxurl+"?action=wu_query_sites&term_sites="+i("#wu-ajax-excludes").val(),dataType:"json"}).done(function(e){t(i.map(e,function(e){return{text:e.blogname+" ("+e.domain+e.path+")",slug:e.domain,id:e.blog_id}}))})},minimumInputLength:2,tags:[],ajax:{url:ajaxurl,dataType:"json",type:"GET",quietMillis:50,data:function(e){return{term_sites:e,action:"wu_query_sites"}},results:function(e){return{results:i.map(e,function(e){if("1"!==e.blog_id)return{text:e.blogname+" ("+e.domain+e.path+")",slug:e.domain,id:e.blog_id};console.log("Something error: ajax search select2")})}}}})})}(jQuery),function(i){i(document).ready(function(){wu_admin_page_submit_box=new Vue({el:"#postbox-container-1",data:{menu_type:wu_apc_settings.menu_type,page_to_replace:wu_apc_settings.page_to_replace?wu_apc_settings.page_to_replace:"index.php",replace_mode:wu_apc_settings.replace_mode?wu_apc_settings.replace_mode:"all",content_type:wu_apc_settings.content_type?wu_apc_settings.content_type:"normal",external_link_url_embedable:!0,widget_priority:wu_apc_settings.widget_priority?wu_apc_settings.widget_priority:"high",widget_position:wu_apc_settings.widget_position?wu_apc_settings.widget_position:"normal",widget_welcome:wu_apc_settings.widget_welcome,widget_welcome_dismissible:wu_apc_settings.widget_welcome_dismissible,apply_multiple_pages:wu_apc_settings.apply_multiple_pages},mounted:function(){i("#menu_icon_selector").fontIconPicker(),this.check_apply_multiple_pages(this.apply_multiple_pages)},updated:function(){},watch:{menu_type:function(e){wu_editor_type.menu_type=e,wu_admin_page_advanced_options.menu_type=e,this.check_iframe_conditional(e),"hide_page"==this.content_type&&"replace"==this.menu_type||"hide_page"==this.content_type&&"replace_submenu"==this.menu_type?(this.remove_select_multiple(),this.apply_multiple_pages=!0):this.apply_multiple_pages=!1,this.check_apply_multiple_pages(this.apply_multiple_pages)},content_type:function(e){"hide_page"===e&&(this.menu_type="replace",this.apply_multiple_pages=!0)},apply_multiple_pages:function(e){this.check_apply_multiple_pages(e)}},methods:{check_apply_multiple_pages:function(e){e?setTimeout(function(e){i("#page_to_replace").attr("multiple","multiple"),i("#page_to_replace").attr("name","pages_to_replace[]"),i("#page_to_replace").select2(),i("#page_to_replace").select2("val",e)},400,this.page_to_replace):this.remove_select_multiple()},remove_select_multiple:function(){i("#page_to_replace").select2("destroy"),i("#page_to_replace").removeAttr("multiple"),i("#page_to_replace").attr("name","page_to_replace")},check_iframe_conditional:function(e){"replace"!=e&&"replace_submenu"!=e&&"widget"!=e||i("#external_link_iframe").prop("checked",!0)}}}),wu_admin_page_permissions=new Vue({el:"#wu_permissions",mounted:function(){install_user_select()},data:{limit_access:wu_apc_settings.limit_access}}),wu_admin_page_advanced_options=new Vue({el:"#postbox-container-2 .inside #wu_separator",data:{menu_type:wu_apc_settings.menu_type,content_type:wu_apc_settings.content_type,conditionaly_input:!("widget"==wu_apc_settings.menu_type||"submenu"==wu_apc_settings.menu_type),separator_before:wu_apc_settings.separator_before,separator_after:wu_apc_settings.separator_after},watch:{menu_type:function(e){this.separator_after="widget"==e||"submenu"==e?(this.conditionaly_input=!1,this.separator_before=!1):(this.conditionaly_input=!0,this.separator_before=wu_apc_settings.separator_before,wu_apc_settings.separator_after)}}}),wu_editor_type=new Vue({el:"#wu-apc-editor-app",delimiters:["<%","%>"],data:{menu_type:wu_apc_settings.menu_type,content_type:wu_apc_settings.content_type?wu_apc_settings.content_type:"normal",editorInitialized:!1,cssEditorInitialized:!1,jsEditorInitialized:!1,template_id:void 0!==window["wu_apc_"+wu_apc_settings.content_type+"_options"]?window["wu_apc_"+wu_apc_settings.content_type+"_options"].template_id:"",external_link_url:wu_apc_settings.external_link_url,external_link_url_embedable:!0,external_link_url_checking:!0},watch:{content_type:function(e){"html"==e&&this.setHTML(),wu_admin_page_submit_box.content_type=e},external_link_url_embedable:function(e){wu_admin_page_submit_box.external_link_url_embedable=e},external_link_url:function(e){this.check_embedable(e)}},mounted:function(){i(".wu-tooltip").tipTip();var e=this;"html"==this.content_type&&this.setHTML(),"external_link"==this.content_type&&this.check_embedable(this.external_link_url),i(".wu-code-css").on("click",function(){!1===e.cssEditorInitialized&&(wp.codeEditor.initialize("css-content",wu_apc_editor_css_editor_settings),e.cssEditorInitialized=!0)}),i(".wu-code-js").on("click",function(){!1===e.jsEditorInitialized&&(wp.codeEditor.initialize("js-content",wu_apc_editor_js_editor_settings),e.jsEditorInitialized=!0)}),i(".wu-select-all").click(function(e){e.preventDefault();var t=i(this).data("is-selected");i("#"+i(this).data("select-all")).find(":input").prop("checked",!t),i(this).data("is-selected",!t)})},methods:{check_embedable:function(e){var t=this;t.external_link_url_checking=!0,i.get({type:"GET",url:ajaxurl,data:{action:"wu_is_embedable",url:e,_wpnonce:i("#_iframe_wpnonce").val()}}).done(function(e){t.external_link_url_embedable=e,t.external_link_url_checking=!1})},setHTML:function(){this.editorInitialized||(setTimeout(function(){wp.codeEditor.initialize("html-content",wu_apc_editor_html_editor_settings)},0),this.editorInitialized=!0)},checkType:function(e){return this.content_type==type}}})})}(jQuery);