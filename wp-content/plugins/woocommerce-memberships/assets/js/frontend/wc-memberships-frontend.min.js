"use strict";jQuery(function(c){var s=null!==window.wc_memberships_frontend?window.wc_memberships_frontend:{},n={},f=[];function r(){c.fn.select2&&c(".wc-memberships-member-profile-field select").not(".select2-hidden-accessible").select2().addClass("select2-initialized");var e=c(".wc-memberships-member-profile-field"),r=c(".form-row");r.not(e).find(".woocommerce-input-wrapper :input").on("keydown click focus",function(){e.find(".description").prop("aria-hidden",!0).slideUp(250)}),e.each(function(){var i=c(this),e=i.find(".description");i.find('.woocommerce-input-wrapper input[type="checkbox"], .woocommerce-input-wrapper input[type="radio"]').off(),e.hide(),i.hasClass("wc-memberships-member-profile-field wc-memberships-member-profile-field-input-file")?i.find("label, .wc-memberships-profile-field-input-file-dropzone").on("click",function(){o(i,r)}):i.hasClass("wc-memberships-member-profile-field-input-multiselect")?c(this).find("label, .select2-selection").on("click change",function(){o(i,r)}):(i.hasClass("wc-memberships-member-profile-field-input-select")&&i.find(".select2-selection").on("click change",function(){o(i,r)}),i.find("input, textarea, select, label").not(".select2-selection").on("keydown click",function(){if(c(this).is("label")){var e=c(this).attr("for"),e=c("#"+e);if(e.is(":text")||e.is("textarea")||e.is("select"))return}o(i,r)}))}),c(".wc-memberships-member-profile-field-input-file").each(function(){var n=c(this),o=n.find(".wc-memberships-profile-field-input-file-dropzone"),l=n.find(".wc-memberships-profile-field-input-file-preview"),t=n.find(".wc-memberships-profile-field-input-file-upload-progress"),d=n.find(".wc-memberships-profile-field-input-file-feedback"),a=n.find('input[type="hidden"]'),i=a.data("slug"),e={url:s.ajax_url,browse_button:o[0],drop_element:o[0],multi_selection:1<s.max_files,multipart_params:{action:"wc_memberships_upload_profile_field_file",security:s.nonces.profile_field_upload_file,profile_field:i},filters:{max_file_size:s.max_file_size,mime_types:s.mime_types}},r=new plupload.Uploader(e);r.init(),f.push(r),r.bind("Error",function(e,i){i=s.i18n.upload_error.replace("%1$s",i.code).replace("%2$s",i.message);return d.html(i).removeClass("hide"),t.addClass("hide")}),r.bind("FilesAdded",function(e,i){return d.html("").addClass("hide"),o.addClass("disabled"),t.removeClass("hide"),r.start()}),r.bind("UploadProgress",function(e,i){return t.find(".bar").css("width",i.percent+"%")}),r.bind("FileUploaded",function(e,i,r){var s=JSON.parse(r.response);return!s||s.errors?(t.addClass("hide"),o.removeClass("disabled"),s&&s.length?void d.html(s.errors.upload_error).removeClass("hide"):void console.log(r.response)):(c("#woocommerce-register-nonce").val(s.security),a.val(s.id).trigger("change"),l.removeClass("hide").find("a.file").prop("href",s.url).text(s.title),o.addClass("hide").removeClass("disabled"),t.addClass("hide").find(".bar").css("width",0),n.find(".moxie-shim").addClass("hide"))}),n.find("a.remove-file").on("click",function(e){e.preventDefault(),l.addClass("hide").find("a.file").prop("href","").text(""),o.removeClass("hide disabled");e={action:"wc_memberships_remove_profile_field_file",security:s.nonces.profile_field_remove_file,file:a.val(),profile_field:i};return c.post(s.ajax_url,e,function(e){e&&e.success||console.log(e)}).always(function(){a.val("").trigger("change")}),n.find(".moxie-shim").removeClass("hide")})})}function o(e,i){var r=e.find("span.description");r.is(":visible")||r.prop("aria-hidden",!1).slideDown(250),i.not(e).find(".description").prop("aria-hidden",!0).slideUp(250)}function l(e,i){e.find(".woocommerce-variation-add-to-cart").prepend(i),r()}function t(e){f.length&&f.forEach(function(e){e.destroy(),e=null}),e.find(".wc-memberships-member-profile-field select.select2-initialized").select2("destroy"),e.find(".wc-memberships-profile-fields-wrapper").remove()}c("form.variations_form").on("show_variation wcm_show_variation",function(e){var i=c('input[name="variation_id"]').val(),r=c(e.currentTarget);if(t(r),!i)return!0;i in n?l(r,n[i]):(r.block({message:null}),c.post(s.ajax_url,{action:"wc_memberships_get_variation_profile_fields",security:s.nonces.get_product_profile_fields,product_id:i},function(e){e.success&&e.data.length&&(l(r,e.data),n[i]=e.data)}).always(function(){r.unblock()}))}).on("woocommerce_variation_has_changed",function(e){c('input[name="variation_id"]').val()||t(c(e.currentTarget))}),r()});