!function(a){function n(e,r){"full"==e&&(a(r).siblings(".rule_embed_url_value_post + span").hide(),a(r).siblings(".rule_embed_url_value_full").show()),"post_id"==e&&(a(r).siblings(".rule_embed_url_value_full").hide(),a(r).siblings(".rule_embed_url_value_post + span").show()),"all"==e&&(a(r).siblings(".rule_embed_url_value_post + span").hide(),a(r).siblings(".rule_embed_url_value_full").hide()),a(r).siblings("label.error").hide()}function _(){a("#rule_time_period_type").change(function(){e(a(this).val())})}function e(e){"time_period"==e&&(a("#rule_calendar_period").hide(),a("#rule_time_period_value").show(),a("#rule_time_period_unit").show()),"calendar_period"==e&&(a("#rule_time_period_value").hide(),a("#rule_time_period_unit").hide(),a("#rule_calendar_period").show()),"calendar_period"!=e&&"time_period"!=e&&(a("#rule_time_period_value").hide(),a("#rule_time_period_unit").hide(),a("#rule_calendar_period").hide())}function d(){a(".rule_embed_url").change(function(){n(a(this).val(),this)})}function o(){a(".rule_ip").change(function(){"specific"==a(this).val()?a(this).siblings(".rule_ip_specific").show():a(this).siblings(".rule_ip_specific").hide()})}function s(){var e=a("#limit_rules_data").val();return e?JSON.parse(e):[]}function p(e){var r=JSON.stringify(e);a("#limit_rules_data").val(r),a(".limit_rules_data").trigger("change")}function c(){a(".rule_type_selector").on("change",function(){var e=a(this).val(),r=".rule_"+e;a(this).siblings(".rule_value_selector, .rule_value_selector + span").hide();var i=a(this).siblings("{0}, {0} + span".format(r)).show();"embed_url"==e&&i.val("all")})}function h(){a("#add_rule_group").off("click"),a("#add_rule_group").on("click",function(e){e.preventDefault();var r,i,l=(r=a(".rule_group"),i=0,r.each(function(){var e=a(this).attr("id").replace("rule_group_","");i<=e&&(i=parseInt(e)+1)}),"rule_group_"+i),u=window.ruleGroupTemplate;1<=a(".rule_group").length&&a(".ruleset").append('<h4 class="gpls-or-header" id="'+l+'_header">&mdash; OR &mdash;</h4>'),a(".ruleset").append('<div id="'+l+'" class="rule_group"> '+u+" </div>"),m("#"+l,[gpls_repeater_default_rule]);var t=s();t["#"+l]=[gpls_repeater_default_rule],p(t)})}function i(e){a(e.selector).remove(),a(e.selector+"_header").remove();var r=s();delete r[e.selector],p(r),function(){var e=a(".rule_group").first();if(0==e.length)return;a("#"+e.attr("id")+"_header").remove()}()}function m(e,r){a(e).repeater({items:r,limit:0,callbacks:{save:function(e,r){var i,l,u,t;i=e,l=r,u={},f(t=s())||(u=t),1<=l.length&&(u[i.selector]=l),p(u),c(),h()},add:function(e,r,i,l){for(var u in _(),d(),o(),i)if(i.hasOwnProperty(u)){var t=a("."+u+"_"+l);t.is("select")||t.val(i[u])}var s;s=a(r).parents(".rule_group"),a(s).find("select:not( .select2-hidden-accessible )").select2(),c(),h(),a(".rule_type_selector").each(function(){var e=a(this).val(),r=".rule_"+e;a(this).siblings(".rule_value_selector, .rule_value_selector + span").hide(),a(this).siblings("{0}, {0} + span".format(r)).show(),"embed_url"==e&&n(a(this).siblings(".rule_embed_url").val(),this),"ip"==e&&("specific"==a(this).siblings(".rule_ip").val()?a(this).siblings(".rule_ip_specific").show():a(this).siblings(".rule_ip_specific").hide())})},remove:function(e,r){1==e.items.length&&i(e)},repeaterButtons:function(e,r){var i='<a class="add-item '+(e.items.length>=e.options.limit&&0!==e.options.limit?"inactive":"")+'" data-index="'+r+'"><i class="gficon-add"></i></a>';return'<div class="repeater-buttons">'+(i+='<a class="remove-item" data-index="'+r+'"><i class="gficon-subtract"></i></a>')+"</div>"}}})}function f(e){for(var r in e)if(e.hasOwnProperty(r))return!1;return!0}!function(){if(0==a(".ruleset").length)return;window.ruleGroupTemplate=a("#rule_group_0").html(),a(".rule_group").each(function(e){var r="#"+a(this).attr("id"),i=gpls_repeater_items[e];0==i.length&&(i=gpls_repeater_default_rule),m(r,i)}),function(){if(f(s())){var e={"#rule_group_0":[gpls_repeater_default_rule]};p(e)}}(),_(),d(),o(),a("#gform-settings").validate(),a("#rule_group_name").rules("add",{required:!0,minlength:1,messages:{required:"Required input",minlength:jQuery.validator.format("Please enter a Rule Group Name")}}),a("#rule_submission_limit").rules("add",{required:!0,number:!0,min:0,step:1,messages:{required:"Required",minlength:jQuery.validator.format("Please enter a number")}}),a("#rule_time_period_value").rules("add",{number:!0,min:0,step:1,messages:{minlength:jQuery.validator.format("Please enter a number")}}),a(".rule_embed_url_value_full").rules("add",{required:!0,url:!0,messages:{required:"Required"}}),a(".rule_embed_url_value_post").rules("add",{required:!0,number:!0,messages:{required:"Required"}}),e(a("#rule_time_period_type").val()),a("#limit_rules_data").change(function(){a(this).val()})}()}(jQuery);
//# sourceMappingURL=gpls.js.map