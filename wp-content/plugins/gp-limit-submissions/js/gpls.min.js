!function(n){function _(e,r){"full"===e&&(c(r,".rule_embed_url_value_post + span").hide(),c(r,".rule_embed_url_value_full").show()),"post_id"===e&&(c(r,".rule_embed_url_value_full").hide(),c(r,".rule_embed_url_value_post + span").show()),"all"===e&&c(r,".rule_embed_url_value_full").hide(),r.siblings("label.error").hide()}function o(){n("#rule_time_period_type").change(function(){e(n(this).val())})}function e(e){"time_period"==e&&(n("#rule_calendar_period").hide(),n("#rule_time_period_value").show(),n("#rule_time_period_unit").show()),"calendar_period"==e&&(n("#rule_time_period_value").hide(),n("#rule_time_period_unit").hide(),n("#rule_calendar_period").show()),"calendar_period"!=e&&"time_period"!=e&&(n("#rule_time_period_value").hide(),n("#rule_time_period_unit").hide(),n("#rule_calendar_period").hide())}function d(){n(".rule_embed_url").change(function(){_(n(this).val(),n(this))})}function p(){n(".rule_ip").change(function(){var e=n(this).val();console.log("ipType2",e),"specific"==e?c(n(this),".rule_ip_specific").show():c(n(this),".rule_ip_specific").hide()})}function c(e,r,i){var l=e;if(e.hasClass(".row")||(l=e.parents(".row")),n("body").hasClass("gf-legacy-ui"))return e.siblings(r);void 0===i&&(i=!0);var t=n();return l.find(r).each(function(e){var r=i?n(this).parent():n(this);t=t.add(r)}),t}function u(){var e=n("#limit_rules_data").val();return e?JSON.parse(e):[]}function s(e){var r=JSON.stringify(e);n("#limit_rules_data").val(r),n(".limit_rules_data").trigger("change")}function h(e){return void 0!==e.selector&&e.selector,"#"+n(e).attr("id")}function f(){n(".rule_type_selector").on("change",function(){var e=n(this).val(),r=".rule_"+e;c(n(this),".rule_value_selector, .rule_value_selector + span").hide(),c(n(this),"{0}, {0} + span".format(r)).show(),"embed_url"===e&&c(n(this),r,!1).val("all")})}function m(){n("#add_rule_group").off("click"),n("#add_rule_group").on("click",function(e){e.preventDefault();var r,i,l=(r=n(".rule_group"),i=0,r.each(function(){var e=n(this).attr("id").replace("rule_group_","");i<=e&&(i=parseInt(e)+1)}),"rule_group_"+i),t=window.ruleGroupTemplate;1<=n(".rule_group").length&&n(".ruleset").append('<h4 class="gpls-or-header" id="'+l+'_header">&mdash; OR &mdash;</h4>'),n(".ruleset").append('<div id="'+l+'" class="rule_group"> '+t+" </div>"),v("#"+l,[gpls_repeater_default_rule]);var a=u();a["#"+l]=[gpls_repeater_default_rule],s(a)})}function i(e){var r=h(e),i=n(r);i.siblings(r+"_header").remove(),i.remove();var l=u();delete l[r],s(l),function(){var e=n(".rule_group").first();if(0==e.length)return;n("#"+e.attr("id")+"_header").remove()}()}function v(e,r){n(e).repeater({items:r,limit:0,callbacks:{save:function(e,r){var i,l,t,a;i=e,l=r,t={},g(a=u())||(t=a),1<=l.length&&(t[h(i)]=l),s(t),f(),m()},add:function(e,r,i,l){for(var t in o(),d(),p(),i)if(i.hasOwnProperty(t)){var a=e.find("."+t+"_"+l);a.is("select")||a.val(i[t])}var u,s;u=n(r).parents(".rule_group"),s={},n("body").hasClass("gf-legacy-ui")||(s.width="100%"),n(u).find("select:not( .select2-hidden-accessible )").select2(s),f(),m(),n(".rule_type_selector").each(function(){var e=n(this).val(),r=".rule_"+e;c(n(this),".rule_value_selector, .rule_value_selector + span").hide(),c(n(this),"{0}, {0} + span".format(r)).show(),"embed_url"===e&&_(c(n(this),".rule_embed_url",!1).val(),n(this)),"ip"===e&&("specific"===c(n(this),".rule_ip",!1).val()?c(n(this),".rule_ip_specific").show():c(n(this),".rule_ip_specific").hide())})},remove:function(e,r){1==e.items.length&&i(e)},repeaterButtons:function(e,r){var i='<a class="add-item '+(e.items.length>=e.options.limit&&0!==e.options.limit?"inactive":"")+'" data-index="'+r+'"><i class="gficon-add"></i></a>';return'<div class="repeater-buttons">'+(i+='<a class="remove-item" data-index="'+r+'"><i class="gficon-subtract"></i></a>')+"</div>"}}})}function g(e){for(var r in e)if(e.hasOwnProperty(r))return!1;return!0}!function(){if(0==n(".ruleset").length)return;n(".gpls-loading").removeClass("gpls-loading"),window.ruleGroupTemplate=n(".rule_group").first().html(),n(".rule_group").each(function(e){var r="#"+n(this).attr("id"),i=gpls_repeater_items[n(this).attr("id")];0==i.length&&(i=gpls_repeater_default_rule),v(r,i)}),function(){if(g(u())){var e={"#rule_group_0":[gpls_repeater_default_rule]};s(e)}}(),o(),d(),p(),n("#gform-settings").validate(),n("#rule_group_name").rules("add",{required:!0,minlength:1,messages:{required:"Required input",minlength:jQuery.validator.format("Please enter a Rule Group Name")}}),n("#rule_submission_limit").rules("add",{required:!0,numberOrMergeTag:!0,messages:{required:"Required",minlength:jQuery.validator.format("Please enter a number")}}),n("#rule_time_period_value").rules("add",{number:!0,min:0,step:1,messages:{minlength:jQuery.validator.format("Please enter a number")}}),n(".rule_embed_url_value_full").rules("add",{required:!0,url:!0,messages:{required:"Required"}}),n(".rule_embed_url_value_post").rules("add",{required:!0,number:!0,messages:{required:"Required"}}),e(n("#rule_time_period_type").val()),n("#limit_rules_data").change(function(){n(this).val()}),jQuery.validator.addMethod("numberOrMergeTag",function(e,r){return this.optional(r)||!isNaN(parseInt(e))||/^{.+}$/.test(e.trim())},"Please enter a number (or a valid merge tag).")}()}(jQuery);
//# sourceMappingURL=gpls.js.map