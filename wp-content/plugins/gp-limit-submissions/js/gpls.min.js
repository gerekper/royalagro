!function(s){function o(e,t){"full"===e&&(c(t,".rule_embed_url_value_post + span").hide(),c(t,".rule_embed_url_value_full").show()),"post_id"===e&&(c(t,".rule_embed_url_value_full").hide(),c(t,".rule_embed_url_value_post + span").show()),"all"===e&&c(t,".rule_embed_url_value_full").hide(),t.siblings("label.error").hide()}function _(){s("#rule_time_period_type").change(function(){e(s(this).val())})}function e(e){"time_period"==e&&(b()?(s("#rule_calendar_period").hide(),s("#rule_time_period_value").show(),s("#rule_time_period_unit").show()):(s("#rule_calendar_period").parent().hide(),s("#rule_time_period_value").parent().show(),s("#rule_time_period_unit").parent().show())),"calendar_period"==e&&(b()?(s("#rule_time_period_value").hide(),s("#rule_time_period_unit").hide(),s("#rule_calendar_period").show()):(s("#rule_time_period_value").parent().hide(),s("#rule_time_period_unit").parent().hide(),s("#rule_calendar_period").parent().show())),"calendar_period"!=e&&"time_period"!=e&&(b()?(s("#rule_time_period_value").hide(),s("#rule_time_period_unit").hide(),s("#rule_calendar_period").hide()):(s("#rule_time_period_value").parent().hide(),s("#rule_time_period_unit").parent().hide(),s("#rule_calendar_period").parent().hide()))}function d(){s(".rule_embed_url").change(function(){o(s(this).val(),s(this))})}function p(){s(".rule_ip").change(function(){var e=s(this).val();console.log("ipType2",e),"specific"==e?c(s(this),".rule_ip_specific").show():c(s(this),".rule_ip_specific").hide()})}function c(e,t,r){var i=e;if(e.hasClass(".row")||(i=e.parents(".row")),b())return e.siblings(t);void 0===r&&(r=!0);var l=s();return i.find(t).each(function(e){var t=r?s(this).parent():s(this);l=l.add(t)}),l}function u(){var e=s("#limit_rules_data").val();return e?JSON.parse(e):[]}function n(e){var t=JSON.stringify(e);s("#limit_rules_data").val(t),s(".limit_rules_data").trigger("change")}function h(e){return void 0!==e.selector&&e.selector,"#"+s(e).attr("id")}function m(){s(".rule_type_selector").on("change",function(){var e=s(this).val(),t=".rule_"+e;c(s(this),".rule_value_selector, .rule_value_selector + span").hide(),c(s(this),"{0}, {0} + span".format(t)).show(),"embed_url"===e&&c(s(this),t,!1).val("all")})}function f(){s("#add_rule_group").off("click"),s("#add_rule_group").on("click",function(e){e.preventDefault();var t,r,i=(t=s(".rule_group"),r=0,t.each(function(){var e=s(this).attr("id").replace("rule_group_","");r<=e&&(r=parseInt(e)+1)}),"rule_group_"+r),l=window.ruleGroupTemplate;1<=s(".rule_group").length&&s(".ruleset").append('<h4 class="gpls-or-header" id="'+i+'_header">&mdash; OR &mdash;</h4>'),s(".ruleset").append('<div id="'+i+'" class="rule_group"> '+l+" </div>"),v("#"+i,[gpls_repeater_default_rule]);var a=u();a["#"+i]=[gpls_repeater_default_rule],n(a)})}function r(e){var t=h(e),r=s(t);r.siblings(t+"_header").remove(),r.remove();var i=u();delete i[t],n(i),function(){var e=s(".rule_group").first();if(0==e.length)return;s("#"+e.attr("id")+"_header").remove()}()}function v(e,t){s(e).repeater({items:t,limit:0,callbacks:{save:function(e,t){var r,i,l,a;r=e,i=t,l={},g(a=u())||(l=a),1<=i.length&&(l[h(r)]=i),n(l),m(),f()},add:function(e,t,r,i){for(var l in _(),d(),p(),r)if(r.hasOwnProperty(l)){var a=e.find("."+l+"_"+i);a.is("select")||a.val(r[l])}var u,n;u=s(t).parents(".rule_group"),n={},b()||(n.width="100%"),s(u).find("select:not( .select2-hidden-accessible )").select2(n),m(),f(),s(".rule_type_selector").each(function(){var e=s(this).val(),t=".rule_"+e;c(s(this),".rule_value_selector, .rule_value_selector + span").hide(),c(s(this),"{0}, {0} + span".format(t)).show(),"embed_url"===e&&o(c(s(this),".rule_embed_url",!1).val(),s(this)),"ip"===e&&("specific"===c(s(this),".rule_ip",!1).val()?c(s(this),".rule_ip_specific").show():c(s(this),".rule_ip_specific").hide())})},remove:function(e,t){1==e.items.length&&r(e)},repeaterButtonsLegacyGF24:function(e,t){var r="";return e.items.length>=e.options.limit&&0!==e.options.limit||(r+='<a class="add-item" data-index="'+t+'"><i class="gficon-add"></i></a>'),'<div class="repeater-buttons">'+(r+='<a class="remove-item" data-index="'+t+'"><i class="gficon-subtract"></i></a>')+"</div>"},repeaterButtons:function(e,t){if(b())return e.callbacks.repeaterButtonsLegacyGF24(e,t);var r="";return e.items.length>=e.options.limit&&0!==e.options.limit||(r+='<a class="add-item" data-index="'+t+'">\t\t\t\t\t\t\t\t<button \t\t\t\t\t\t\t\ttype="button" \t\t\t\t\t\t\t\tclass="gform-st-icon gform-st-icon--circle-plus" \t\t\t\t\t\t\t\ttitle="add another rule"></button>\t\t\t\t\t\t\t</a>'),'<div class="repeater-buttons">'+(r+='<a class="remove-item" data-index="'+t+'">\t\t\t\t\t\t\t\t<button \t\t\t\t\t\t\t\ttype="button" \t\t\t\t\t\t\t\tclass="gform-st-icon gform-st-icon--circle-minus" \t\t\t\t\t\t\t\ttitle="remove this rule"></button>\t\t\t\t\t\t\t</a>')+"</div>"}}})}function g(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function b(){return s("body").hasClass("gf-legacy-ui")}!function(){if(0==s(".ruleset").length)return;s(".gpls-loading").removeClass("gpls-loading"),window.ruleGroupTemplate=s(".rule_group").first().html(),s(".rule_group").each(function(e){var t="#"+s(this).attr("id"),r=gpls_repeater_items[s(this).attr("id")];0==r.length&&(r=gpls_repeater_default_rule),v(t,r)}),function(){if(g(u())){var e={"#rule_group_0":[gpls_repeater_default_rule]};n(e)}}(),_(),d(),p(),s("#gform-settings").validate(),s("#rule_group_name").rules("add",{required:!0,minlength:1,messages:{required:"Required input",minlength:jQuery.validator.format("Please enter a Rule Group Name")}}),s("#rule_submission_limit").rules("add",{required:!0,numberOrMergeTag:!0,messages:{required:"Required",minlength:jQuery.validator.format("Please enter a number")}}),s("#rule_time_period_value").rules("add",{number:!0,min:0,step:1,messages:{minlength:jQuery.validator.format("Please enter a number")}}),s(".rule_embed_url_value_full").rules("add",{required:!0,url:!0,messages:{required:"Required"}}),s(".rule_embed_url_value_post").rules("add",{required:!0,number:!0,messages:{required:"Required"}}),e(s("#rule_time_period_type").val()),s("#limit_rules_data").change(function(){s(this).val()}),jQuery.validator.addMethod("numberOrMergeTag",function(e,t){return this.optional(t)||!isNaN(parseInt(e))||/^{.+}$/.test(e.trim())},"Please enter a number (or a valid merge tag).")}()}(jQuery);
//# sourceMappingURL=gpls.js.map