!function(e,f){var u;e&&e.customize&&((u=e.customize).SPDesignerPreviewData={webSafeFonts:[]},"undefined"!=typeof _wpCustomizeSPDesignerPreviewSettings&&f.extend(u.SPDesignerPreviewData,_wpCustomizeSPDesignerPreviewSettings),u.SPDesignerPreview={PointClickActive:!1,$activeSelector:"",init:function(){var o=this,n={};u.preview.bind("sp-designer-point-click",function(e){o.PointClickActive=!0===e}),o.setupPointClickUI(),u.each(function(e,t){e.id=t,n[e.id]||o.bindListener(e)&&(n[e.id]=!0)}),u.preview.bind("setting",function(e){var t=(e=e.slice()).shift(),i=e.shift();(e=(e=u(t))||u.create(t,i)).id||(e.id=t),n[e.id]||o.bindListener(e)&&(n[e.id]=!0,e.callbacks.fireWith(e,[e(),null]))})},bindListener:function(e){return!!e.id.match(/^sp_designer_css_data\[(.+?)]/)&&(e.bind(this.updateCSS),!0)},updateCSS:function(e,t){var i,o,n,r;!1!==e?(o={display:"none"===(r=this.get()).updateDisplay?"none":"","font-size":r.fontSize+r.fontSizeUnit,"letter-spacing":r.letterSpacing+r.letterSpacingUnit,"line-height":r.lineHeight+"px","font-style":"italic"===r.fontStyle?"italic":"normal","font-weight":r.fontWeight,"margin-top":r.marginTop+r.marginTopUnit,"margin-bottom":r.marginBottom+r.marginBottomUnit,"margin-left":r.marginLeft+r.marginLeftUnit,"margin-right":r.marginRight+r.marginRightUnit,"padding-top":r.paddingTop+r.paddingTopUnit,"padding-bottom":r.paddingBottom+r.paddingBottomUnit,"padding-left":r.paddingLeft+r.paddingLeftUnit,"padding-right":r.paddingRight+r.paddingRightUnit,color:r.color,"border-width":r.borderWidth+r.borderWidthUnit,"border-style":r.borderStyle,"border-color":r.borderColor,"border-radius":r.borderRadius+r.borderRadiusUnit,"background-color":r.backgroundColor},"Default"===r.fontFamily||""===r.fontFamily?o["font-family"]="":(_.contains(u.SPDesignerPreviewData.webSafeFonts,r.fontFamily)||(i=r.fontFamily,r.fontVariant&&(i=i+":"+r.fontVariant,e=parseInt(r.fontVariant,10),_.isNaN(e)||(o["font-weight"]=e)),WebFont.load({google:{families:[i]}})),o["font-family"]=r.fontFamily),i=[],"underline"===r.textUnderline&&i.push("underline"),"line-through"===r.textLineThrough&&i.push("line-through"),0===i.length&&i.push("none"),i=i.join(" "),o["text-decoration"]=i,r.backgroundImage&&r.backgroundImage.url?(o["background-image"]='url("'+r.backgroundImage.url+'")',o["background-repeat"]=r.backgroundRepeat,o["background-position"]=r.backgroundPosition,o["background-attachment"]=r.backgroundAttachment):o["background-image"]="",n="",_.each(o,function(e,t){""!==e&&(n+=t+":"+e+";")}),o=u.SPDesignerPreviewData.prefixOtherClasses,n="body"===r.selector?"body"+(o=u.SPDesignerPreviewData.prefixBodyClass)+"{"+n+"}":o+" "+r.selector+"{"+n+"}",r=(r=(r=r.selector.replace(/\s+/g,"-").toLowerCase()).toLowerCase()).replace(/[^0-9A-Za-z-]/g,""),f("#sp-designer-"+r).remove(),f(" <style/>").attr("id","sp-designer-"+r).text(n).appendTo(document.head)):f(t.selector).removeAttr("style")},addSelector:function(e){var t=f(e),t={selector:e,cssProperties:{updateDisplay:t.css("display"),fontWeight:t.css("font-weight"),fontSize:t.css("font-size"),letterSpacing:t.css("letter-spacing"),lineHeight:t.css("line-height"),fontStyle:t.css("font-style"),textDecoration:t.css("text-decoration"),color:t.css("color"),borderRadius:t.css("border-radius"),borderColor:t.css("border-color"),borderStyle:t.css("border-style"),borderWidth:t.css("border-width"),marginTop:t.css("margin-top"),marginLeft:t.css("margin-left"),marginRight:t.css("margin-right"),marginBottom:t.css("margin-bottom"),paddingTop:t.css("padding-top"),paddingLeft:t.css("padding-left"),paddingRight:t.css("padding-right"),paddingBottom:t.css("padding-bottom"),backgroundColor:t.css("background-color"),backgroundRepeat:t.css("background-repeat"),backgroundPosition:t.css("background-position"),backgroundAttachment:t.css("background-attachment")}};u.preview.send("sp-designer-click-selector",t)},setupPointClickUI:function(){var a,s,d,c,l,p=this;_.each(u.SPDesignerPreviewData.selectorsMap,function(e){f(e.selector).attr("data-sp-element-selector",e.selector),f(e.selector).attr("data-sp-element-title",e.name)}),a=f("<div/>").addClass("sp-element-border sp-element-border-top"),s=f("<div/>").addClass("sp-element-border sp-element-border-bottom"),d=f("<div/>").addClass("sp-element-border sp-element-border-left"),c=f("<div/>").addClass("sp-element-border sp-element-border-right"),f("body").append(a),f("body").append(s),f("body").append(d),f("body").append(c),l=f("<div/>").addClass("sp-element-label"),f("body").append(l);function g(){p.$activeSelector="",f(".sp-element-same").remove(),f(p.$activeSelector).css({cursor:"auto"}),a.attr("style",""),s.attr("style",""),d.attr("style",""),c.attr("style",""),l.text("").attr("style","")}f("*").on("click",function(){var e;if(!0===p.PointClickActive&&""!==p.$activeSelector)return p.$activeSelector.attr("data-sp-element-selector")&&(e=p.$activeSelector.data("sp-element-selector"),p.addSelector(e),g()),!1}),f("[data-sp-element-selector]").hover(function(){var e=this,t=f(e).data("sp-element-selector"),i=f(e).data("sp-element-title"),o=f(e).offset(),n=f(e).outerWidth(),r=f(e).outerHeight();if(!1===p.PointClickActive)return!1;if(""!==p.$activeSelector&&!f(e).is(p.$activeSelector)){if(!p.$activeSelector.has(f(e)))return!1;g()}p.$activeSelector=f(e),0===o.left&&(o.left=2,n-=4),a.css({top:o.top,left:o.left,width:n}),s.css({top:o.top+r,left:o.left,width:n}),d.css({top:o.top,left:o.left-2,height:r+2}),c.css({top:o.top,left:o.left+n,height:r+2}),l.text(i),l.css({top:o.top+r,left:o.left-2,width:n+4,"min-width":l.outerWidth()}),f(t).not(this).each(function(){var e=f(this).offset(),t=f(this).outerWidth(),i=f(this).outerHeight();f("<div/>").addClass("sp-element-same").css({position:"absolute","z-index":"999999",width:t,height:i,top:e.top,left:e.left}).appendTo("body")}),f(this).css({cursor:"pointer"})},function(){g(),f(this).css({cursor:"auto"})})}},u.bind("preview-ready",function(){u.preview.bind("active",function(){u.SPDesignerPreview.init()})}))}(window.wp,jQuery);